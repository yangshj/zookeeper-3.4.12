
1、入口
org.apache.zookeeper.server.quorum.QuorumPeerMain



2、事务性请求：增加、删除、修改
非事务性请求：读，exit

事务id：zxid，自增， 越大代表数据越新，能力越强
myid: 事务id一样的时候，根据myid来选举


3、事务提交过程
    1、预提交
    2、收到ack
    3、统计过半 commit (两阶段提交)

4、选举
    投票箱
    选票
    能力强者，改票

5、角色
    请求发送到follow时，会转发给leader

6、过半机制
    1、解决脑裂
    2、基数个机器和偶数个机器(可以提高读性能)
    3、observer仅仅提高读性能，不影响写性能


问题：
1、过半提交：如果两台提交，一台没提交，读请求读取到没提交的这台，那么数据不一致。
2、选举：如果两台机器已经确认，并且两台机器的zxid=11, 第三台机器为12，
    第三台机器加入的时候，领导者已经变成了12，此时第三台机器应该回滚。 那么怎么判断此12非彼12呢？